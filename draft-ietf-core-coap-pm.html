<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Constrained Application Protocol (CoAP) Performance Measurement Option</title>
<meta content="Giuseppe Fioccola" name="author">
<meta content="Tianran Zhou" name="author">
<meta content="Massimo Nilo" name="author">
<meta content="Fabio Bulgarella" name="author">
<meta content="
       This document specifies a method for the Performance Measurement of the
Constrained Application Protocol (CoAP). A new CoAP option is defined
in order to enable network telemetry both end-to-end and hop-by-hop.
The endpoints cooperate by marking and, possibly, mirroring information
on the round-trip connection. 
    " name="description">
<meta content="xml2rfc 3.25.0" name="generator">
<meta content="draft-ietf-core-coap-pm-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.25.0
    Python 3.12.8
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.5
    lxml 5.3.0
    platformdirs 4.3.6
    pycountry 24.6.1
    PyYAML 6.0.2
    requests 2.32.3
    setuptools 70.3.0
    wcwidth 0.2.13
-->
<link href="draft-ietf-core-coap-pm.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    /* In the horizontal direction, sometimes people make over-sized figures.
       Scrollbars for those is therefore necessary: auto adds them as necessary..
       In the vertical direction, the line-height can combine with the font
       asender/descender height to produce scrollbars: hidden avoids that. */
    overflow: auto hidden;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">COAP PM</td>
<td class="right">February 2024</td>
</tr></thead>
<tfoot><tr>
<td class="left">Fioccola, et al.</td>
<td class="center">Expires 5 August 2024</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">CORE Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-core-coap-pm-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2024-02-02" class="published">2 February 2024</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2024-08-05">5 August 2024</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">G. Fioccola</div>
<div class="org">Huawei</div>
</div>
<div class="author">
      <div class="author-name">T. Zhou</div>
<div class="org">Huawei</div>
</div>
<div class="author">
      <div class="author-name">M. Nilo</div>
<div class="org">Telecom Italia</div>
</div>
<div class="author">
      <div class="author-name">F. Bulgarella</div>
<div class="org">Telecom Italia</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Constrained Application Protocol (CoAP) Performance Measurement Option</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document specifies a method for the Performance Measurement of the
Constrained Application Protocol (CoAP). A new CoAP option is defined
in order to enable network telemetry both end-to-end and hop-by-hop.
The endpoints cooperate by marking and, possibly, mirroring information
on the round-trip connection.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-discussion-venues">
<a href="#name-discussion-venues" class="section-name selfRef">Discussion Venues</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">Discussion of this document takes place on the
    Constrained RESTful Environments Working Group mailing list (core@ietf.org),
    which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/core/">https://mailarchive.ietf.org/arch/browse/core/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">Source for this draft and an issue tracker can be found at
    <span><a href="https://github.com/core-wg/coap-pm">https://github.com/core-wg/coap-pm</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 5 August 2024.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2024 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-requirements-language" class="internal xref">Requirements Language</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-performance-measurement-met" class="internal xref">Performance Measurement methods for CoAP</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-square-bit-and-spin-bit" class="internal xref">sQuare bit and Spin bit</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="auto internal xref">2.2</a>.  <a href="#name-combined-square-bit" class="internal xref">Combined sQuare bit</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-coap-performance-measuremen" class="internal xref">CoAP Performance Measurement Option</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-structure-of-the-pm-option" class="internal xref">Structure of the PM Option</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-application-scenarios" class="internal xref">Application Scenarios</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-non-proxying-endpoints" class="internal xref">Non-proxying endpoints</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-collaborating-proxies" class="internal xref">Collaborating proxies</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-non-collaborating-proxies" class="internal xref">Non-collaborating proxies</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.1">
                    <p id="section-toc.1-1.4.2.3.2.1.1"><a href="#section-4.3.1" class="auto internal xref">4.3.1</a>.  <a href="#name-non-caching-proxies" class="internal xref">Non-caching proxies</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="auto internal xref">4.4</a>.  <a href="#name-dtls" class="internal xref">DTLS</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a href="#section-4.5" class="auto internal xref">4.5</a>.  <a href="#name-oscore" class="internal xref">OSCORE</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-management-and-configuratio" class="internal xref">Management and Configuration</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-congestion-control" class="internal xref">Congestion Control</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="auto internal xref">9.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="auto internal xref">9.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#appendix-A" class="auto internal xref"></a><a href="#name-acknowledgements" class="internal xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-contributors" class="internal xref">Contributors</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-C" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">In the CoAP protocol <span>[<a href="#RFC7252" class="cite xref">RFC7252</a>]</span>, reliability is provided by marking a message
as Confirmable (CON), as to be retransmitted if not acknowledged by an ACK
message.
A message that does not require reliable transmission can be sent as a Non-confirmable
message (NON).<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">In case of CoAP reliable mode, Message IDs and ACKs could potentially be
used to measure Round-Trip Time (RTT) and losses.
But it can be resource-consuming for constrained nodes since they have to
look at Message IDs and take timestamps.
These operations are expensive in terms of resources. In case of CoAP unreliable
mode, there is no ACK and, consequently, it is not possible to measure RTT and losses.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">Thus, there is no easy way to measure the performance metrics in a CoAP environment
including resource-constrained nodes.
And it is in any case limited to RTT and end-to-end losses.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">A mechanism to measure both end-to-end and hop-by-hop performance in CoAP
can be useful to verify that the operational requirements are met, but it should be
a simple mechanism for network diagnostic to be developed on constrained nodes
requiring just a minimal amount of collaboration from the endpoints.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5"><span>[<a href="#RFC9506" class="cite xref">RFC9506</a>]</span> describes the methodologies for Explicit Flow Measurement (EFM).
The EFM techniques employ few marking bits, inside the header of each packet,
for loss and delay measurement.
These are relevant for encrypted protocols, e.g. QUIC <span>[<a href="#RFC9000" class="cite xref">RFC9000</a>]</span>, where there are only
few bits available in the non-encrypted header in order to allow passive
performance metrics from an on-path probe.
These methodologies could potentially be used and extended in CoAP.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6"><span>[<a href="#RFC9506" class="cite xref">RFC9506</a>]</span> defines different combinations of bits.
Such flexibility is convenient when using a protocol with a limited number of
eligible bits to exploit, e.g., QUIC.
Different alternatives have been proposed, but all these methods together
imply complex algorithms that do not apply well to the CoAP environment.<a href="#section-1-6" class="pilcrow">¶</a></p>
<p id="section-1-7">This document aims to create an easy way to allow performance measurement
for CoAP, by defining a new option, called Performance Measurement (PM) CoAP Option.
The CoAP performance metrics (e.g. RTT and losses) allow performing
both end-to-end and hop-by-hop measurements and can be useful for an operator
or an enterprise that is managing a constrained, low-power and lossy network.<a href="#section-1-7" class="pilcrow">¶</a></p>
<p id="section-1-8">This document ultimately is intended to be published as a standards-track RFC.
Its current stage of development, it is complete and stable enough to
be used as a basis for experiments, the evaluation and continuation of
which will lead to further evolution towards the intended
standards-track document.<a href="#section-1-8" class="pilcrow">¶</a></p>
<div id="requirements-language">
<section id="section-1.1">
        <h3 id="name-requirements-language">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-requirements-language" class="section-name selfRef">Requirements Language</a>
        </h3>
<p id="section-1.1-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="PMmethods">
<section id="section-2">
      <h2 id="name-performance-measurement-met">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-performance-measurement-met" class="section-name selfRef">Performance Measurement methods for CoAP</a>
      </h2>
<p id="section-2-1">The approach proposed in this document relies on a new Performance Measurement
(PM) Option for CoAP <span>[<a href="#RFC7252" class="cite xref">RFC7252</a>]</span>.
This new option is defined in <a href="#PMO" class="auto internal xref">Section 3</a> and carries PM bits.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">The PM bits that are included in the Option are:<a href="#section-2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2-3.1">
          <p id="section-2-3.1.1">sQuare bit (Q bit), based on <span>[<a href="#RFC9341" class="cite xref">RFC9341</a>]</span> and further described in <span>[<a href="#RFC9506" class="cite xref">RFC9506</a>]</span>;<a href="#section-2-3.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-3.2">
          <p id="section-2-3.2.1">Spin bit (S bit), described in <span>[<a href="#RFC9312" class="cite xref">RFC9312</a>]</span> and included as optional bit in <span>[<a href="#RFC9000" class="cite xref">RFC9000</a>]</span>;<a href="#section-2-3.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-3.3">
          <p id="section-2-3.3.1">Loss and Delay event information for further usage.<a href="#section-2-3.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-2-4">A requirement to enable PM methods in CoAP environment is that the methodologies
and the algorithm needs to be kept simple.
For this reason, the idea is to re-apply only the S bit and Q bit.<a href="#section-2-4" class="pilcrow">¶</a></p>
<p id="section-2-5">Thus, the advantages of using the CoAP PM Option are:<a href="#section-2-5" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2-6">
<li id="section-2-6.1">
          <p id="section-2-6.1.1">Simplification because it is not needed to read Message IDs, indeed there
is a well-defined sQuare wave, and it is not necessary to store timestamps,
since the duration of the Spin Bit period is equal to RTT.<a href="#section-2-6.1.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-2-6.2">
          <p id="section-2-6.2.1">Enabling easy on-path probe (proxy, gateway) metrics.<a href="#section-2-6.2.1" class="pilcrow">¶</a></p>
</li>
      </ol>
<div id="QSbits">
<section id="section-2.1">
        <h3 id="name-square-bit-and-spin-bit">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-square-bit-and-spin-bit" class="section-name selfRef">sQuare bit and Spin bit</a>
        </h3>
<p id="section-2.1-1">The sQuare bit algorithm consists of creating square waves of a known length
(e.g. 64 packets). Each communicating endpoint can set
the Q bit and toggle its value each time a fixed number of messages have
been sent. The number of packets can be easily recognized
and packet loss can be measured.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<p id="section-2.1-2">The Spin bit algorithm consists of creating a square wave signal on the data
flow, using a bit, whose length is equal to RTT.
The Spin bit causes one bit to ‘spin’, generating one edge (a transition
from 0 to 1 or from 1 to 0) once per end-to-end RTT.
When sending a new request, a client sets the spin bit to the opposite value
it had in the immediately previously sent request to the same server.
Then, the server echoes the same value of the spin bit of the request
in the spin bit of the response.
Therefore, the Spin bit is set by both sides to the same value for as long
as one round trip lasts and then it toggles the value.<a href="#section-2.1-2" class="pilcrow">¶</a></p>
<p id="section-2.1-3">An on-path probe can read the Q bit and S bit signals and perform the measurements.
All the possible measurements (end-to-end, hop-by-hop) that are enabled by
the Q bit and S bit are detailed in <span>[<a href="#RFC9506" class="cite xref">RFC9506</a>]</span>.<a href="#section-2.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Cbit">
<section id="section-2.2">
        <h3 id="name-combined-square-bit">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-combined-square-bit" class="section-name selfRef">Combined sQuare bit</a>
        </h3>
<p id="section-2.2-1">The synergy between S bit and Q bit is also possible. As described above,
the length of the Q bit square waves is fixed (e.g. a predefined number of packets)
in this way each endpoint can detect a packet loss if it receives fewer packets than
the other endpoint has sent.
It is possible to potentiate the Q bit signal by incorporating RTT information
as well. This implies a little modification to the algorithm of the Q bit
that could also be used alone:<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2.2-2.1">
            <p id="section-2.2-2.1.1">A single packet in a period of the square wave can be selected and set to
the opposite value of that period. After one RTT it comes back and another packet
is selected and set again to the opposite value of that period.
And the process can start again. By measuring the distance between these
special packets, it is possible to measure the RTT in addition to packet loss.
The periods with the special packets have one packet less than expected but this is
easy to recognize and to take into account by both endpoints.<a href="#section-2.2-2.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-2.2-3">The Q bit and S bit signals use two single bit values and the new signal
is a Combined sQuare bit (C bit) signal.
This mechanism uses a single bit that serves two purposes: a loss indicator
and a delay indicator.
It is worth highlighting that it is similar to the Delay bit (D bit), described
in <span>[<a href="#RFC9506" class="cite xref">RFC9506</a>]</span>.
Indeed, the D bit, as enhancement of the S bit, is set only once per RTT
and a single packet with the marked Delay bit bounces
between a client and a server. The C bit value can also be seen as an Exclusive
OR operation (XOR) between the two Q bit and D bit values:
C = Q XOR D.<a href="#section-2.2-3" class="pilcrow">¶</a></p>
<p id="section-2.2-4">Since C bit incorporates both Q bit and S bit information, the same considerations
for the two separate signals in <span>[<a href="#RFC9506" class="cite xref">RFC9506</a>]</span> can also be extended in the case of C bit.
Therefore, all the possible measurements (end-to-end, hop-by-hop) that are
enabled by using only C bit can be found in <span>[<a href="#RFC9506" class="cite xref">RFC9506</a>]</span> by merging Q bit and S bit
derived measurements.<a href="#section-2.2-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="PMO">
<section id="section-3">
      <h2 id="name-coap-performance-measuremen">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-coap-performance-measuremen" class="section-name selfRef">CoAP Performance Measurement Option</a>
      </h2>
<p id="section-3-1"><a href="#PMoption" class="auto internal xref">Table 1</a> shows the property of the CoAP Performance Measurement (PM) Option.
The formatting of this table is reported in <span>[<a href="#RFC7252" class="cite xref">RFC7252</a>]</span>.
The C, U, N, and R columns indicate the properties Critical, Unsafe, NoCacheKey,
and Repeatable as defined in <span>[<a href="#RFC7252" class="cite xref">RFC7252</a>]</span>.<a href="#section-3-1" class="pilcrow">¶</a></p>
<span id="name-coap-pm-option-properties-c"></span><div id="PMoption">
<table class="center" id="table-1">
        <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-coap-pm-option-properties-c" class="selfRef">CoAP PM Option Properties (C=Critical, U=Unsafe, N=NoCacheKey, R=Repeatable)</a>
        </caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">Number</th>
            <th class="text-left" rowspan="1" colspan="1">C</th>
            <th class="text-left" rowspan="1" colspan="1">U</th>
            <th class="text-left" rowspan="1" colspan="1">N</th>
            <th class="text-left" rowspan="1" colspan="1">R</th>
            <th class="text-left" rowspan="1" colspan="1">Name</th>
            <th class="text-left" rowspan="1" colspan="1">Format</th>
            <th class="text-left" rowspan="1" colspan="1">Length</th>
            <th class="text-left" rowspan="1" colspan="1">Default</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">TBD</td>
            <td class="text-left" rowspan="1" colspan="1"> </td>
            <td class="text-left" rowspan="1" colspan="1">x</td>
            <td class="text-left" rowspan="1" colspan="1">-</td>
            <td class="text-left" rowspan="1" colspan="1"> </td>
            <td class="text-left" rowspan="1" colspan="1">PM</td>
            <td class="text-left" rowspan="1" colspan="1">uint</td>
            <td class="text-left" rowspan="1" colspan="1">1</td>
            <td class="text-left" rowspan="1" colspan="1">0</td>
          </tr>
        </tbody>
      </table>
</div>
<p id="section-3-3">The CoAP PM Option is Elective and Proxy Unsafe. But as discussed in <a href="#ncproxies" class="auto internal xref">Section 4.3</a>, it <span class="bcp14">MAY</span> also
be Safe-to-Forward in some implementations with non-caching proxies.<a href="#section-3-3" class="pilcrow">¶</a></p>
<p id="section-3-4">As detailed in <a href="#oscore" class="auto internal xref">Section 4.5</a>, the option can be of class U, I and E in terms of OSCORE processing.<a href="#section-3-4" class="pilcrow">¶</a></p>
<p id="section-3-5">Note that it could be possible to make use of one bit in the option to identify
the mode. In this way two patterns can be defined.<a href="#section-3-5" class="pilcrow">¶</a></p>
<div id="structure-of-the-pm-option">
<section id="section-3.1">
        <h3 id="name-structure-of-the-pm-option">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-structure-of-the-pm-option" class="section-name selfRef">Structure of the PM Option</a>
        </h3>
<p id="section-3.1-1">The value of the PM option is a 1 byte unsigned integer.
This integer value encodes the following fields:<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<span id="name-value-of-the-coap-performan"></span><div id="PM">
<figure id="figure-1">
          <div class="alignLeft art-text artwork" id="section-3.1-2.1">
<pre>
                        0
                        0 1 2 3 4 5 6 7
                       +-+-+-+-+-+-+-+-+
                       |M|   Pattern   |
                       +-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-value-of-the-coap-performan" class="selfRef">Value of the CoAP Performance Measurement Option</a>
          </figcaption></figure>
</div>
<p id="section-3.1-3">Where:<a href="#section-3.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-4.1">
            <p id="section-3.1-4.1.1">The Mode bit (M bit) can be set to 1 or 0.  It is used to identify whether
the Option follows pattern 0 (M bit = 0) or pattern 1 (M bit = 1).<a href="#section-3.1-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-4.2">
            <p id="section-3.1-4.2.1">Pattern bits can be of two kinds as reported below.<a href="#section-3.1-4.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.1-5">The PM Option can employ two patterns based on the value of the M bit:<a href="#section-3.1-5" class="pilcrow">¶</a></p>
<span id="name-coap-performance-measurement"></span><div id="PM0">
<figure id="figure-2">
          <div class="alignLeft art-text artwork" id="section-3.1-6.1">
<pre>
                        0
                        0 1 2 3 4 5 6 7
                       +-+-+-+-+-+-+-+-+
                       |0|Q|S|  Event  |
                       +-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-coap-performance-measurement" class="selfRef">CoAP Performance Measurement Option pattern 0</a>
          </figcaption></figure>
</div>
<span id="name-coap-performance-measurement-"></span><div id="PM1">
<figure id="figure-3">
          <div class="alignLeft art-text artwork" id="section-3.1-7.1">
<pre>
                        0
                        0 1 2 3 4 5 6 7
                       +-+-+-+-+-+-+-+-+
                       |1|C|   Event   |
                       +-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-coap-performance-measurement-" class="selfRef">CoAP Performance Measurement Option pattern 1</a>
          </figcaption></figure>
</div>
<p id="section-3.1-8">The CoAP Option could be defined with 2 PM bits (S and Q) or defined with
a single PM bit (C bit).<a href="#section-3.1-8" class="pilcrow">¶</a></p>
<p id="section-3.1-9">Where:<a href="#section-3.1-9" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-10.1">
            <p id="section-3.1-10.1.1">Q bit is used in pattern 0. It is described in <span>[<a href="#RFC9506" class="cite xref">RFC9506</a>]</span>;<a href="#section-3.1-10.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-10.2">
            <p id="section-3.1-10.2.1">S bit is used in pattern 0. It is described in <span>[<a href="#RFC9312" class="cite xref">RFC9312</a>]</span> and also embedded in the QUIC Protocol <span>[<a href="#RFC9000" class="cite xref">RFC9000</a>]</span>;<a href="#section-3.1-10.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-10.3">
            <p id="section-3.1-10.3.1">C bit is used in pattern 1. It is based on the enhancement of the Q bit signal
with the S bit information. The two methods are described in <span>[<a href="#RFC9506" class="cite xref">RFC9506</a>]</span> and coupled as detailed in <a href="#Cbit" class="auto internal xref">Section 2.2</a>;<a href="#section-3.1-10.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-10.4">
            <p id="section-3.1-10.4.1">Event bits <span class="bcp14">MAY</span> be used to encode additional Loss and Delay information based on well-defined encoding;
they can also be used by on-path probes. If these Event bits are all zero, they <span class="bcp14">MUST</span> be ignored on receipt.
Note that, if pattern 1 is used instead of pattern 0, there is an extra bit available for the event bits
in order to carry additional information for the on-path probe.<a href="#section-3.1-10.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.1-11">It is worth noting that the only differences between the two patterns are
related to the accuracy of the measurements and to the number of event bits.
Further details can be found in <span>[<a href="#RFC9506" class="cite xref">RFC9506</a>]</span>.<a href="#section-3.1-11" class="pilcrow">¶</a></p>
<p id="section-3.1-12">The Event bits can be divided into two parts, for instance: loss event bits and delay event bits.
Based on the average RTT, an endpoint can define different levels of thresholds
and set the delay event bits accordingly.
The same applies to loss event bits. In this way an on-path probe becomes
aware of the network conditions by simply reading these Event bits
and without applying any algorithm.<a href="#section-3.1-12" class="pilcrow">¶</a></p>
<p id="section-3.1-13">The on-path probe can read the event signaling bits and could be the Proxy
or the Gateway which interconnects disjointed CoAP networks.
It <span class="bcp14">MAY</span> communicate with Client and Server to set some parameters
such as timeout based on the network performance.<a href="#section-3.1-13" class="pilcrow">¶</a></p>
<p id="section-3.1-14">The CoAP PM Option described in this document can be used in both requests
and responses. If a CoAP endpoint does not implement the measurement methodologies,
it can simply exclude the option in the outgoing message.
In this way the other CoAP endpoints become aware that the measurement cannot
be executed in that case.<a href="#section-3.1-14" class="pilcrow">¶</a></p>
<p id="section-3.1-15">The fixed number of packets to create the Q bit (or C bit) signal is predefined:
its value is configured from the beginning for all the CoAP endpoints, as also mentioned in <a href="#MaO" class="auto internal xref">Section 5</a>.<a href="#section-3.1-15" class="pilcrow">¶</a></p>
<p id="section-3.1-16">It is worth mentioning that in some specific circumstances, e.g. CoAP clients
that "observe" resources <span>[<a href="#RFC7641" class="cite xref">RFC7641</a>]</span> or empty-ACKs, the measurements can be done only for one direction.
For bidirectional measurements, it is required to have traffic in both directions.<a href="#section-3.1-16" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="application-scenarios">
<section id="section-4">
      <h2 id="name-application-scenarios">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-application-scenarios" class="section-name selfRef">Application Scenarios</a>
      </h2>
<p id="section-4-1">The main usage of the CoAP PM Option is to do end-to-end measurement between
the client and the server, but it can also allow on-path measurements.
The on-path measurement is the additional feature.
This information can be used to monitor the network in order to check the
operational performance and to employ further network optimization.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">The intermediaries or on-path nodes could be:<a href="#section-4-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-3.1">
          <p id="section-4-3.1.1">Probes that must be able to see deep into application.<a href="#section-4-3.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-3.2">
          <p id="section-4-3.2.1">Proxies that, as specified in <span>[<a href="#RFC7252" class="cite xref">RFC7252</a>]</span>, are CoAP endpoints tasked by CoAP clients
to perform requests on their behalf.<a href="#section-4-3.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<div id="np">
<section id="section-4.1">
        <h3 id="name-non-proxying-endpoints">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-non-proxying-endpoints" class="section-name selfRef">Non-proxying endpoints</a>
        </h3>
<p id="section-4.1-1">The CoAP PM Option can be applied end-to-end between client and server and,
since it is Elective, it can be ignored by an endpoint
that does not understand it.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<span id="name-scenario-with-non-proxying-"></span><div id="Fig.1">
<figure id="figure-4">
          <div class="alignLeft art-text artwork" id="section-4.1-2.1">
<pre>
     +--------+                               +--------+
     | Client |---------------+---------------| Server |
     +--------+               |               +--------+
                              |
                            probe
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-scenario-with-non-proxying-" class="selfRef">Scenario with non-proxying endpoints</a>
          </figcaption></figure>
</div>
<p id="section-4.1-3">The enabled measurements are:<a href="#section-4.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1-4.1">
            <p id="section-4.1-4.1.1">end-to-end loss and delay measurements between Client and Server,<a href="#section-4.1-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.1-4.2">
            <p id="section-4.1-4.2.1">on-path upstream and downstream loss and delay components (as explained in <span>[<a href="#RFC9506" class="cite xref">RFC9506</a>]</span>)
if there is a probe (e.g. network functions).<a href="#section-4.1-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.1-4.3">
            <p id="section-4.1-4.3.1">on-path intra-domain loss and delay portion if there are more than one probe
as a result of the difference between the computed
upstream or downstream components (as explained in <span>[<a href="#RFC9506" class="cite xref">RFC9506</a>]</span>).<a href="#section-4.1-4.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.1-5">The on-path network probes can read Q bit and S bit (or C bit) and implement
the relevant algorithms to measure losses and RTT.
Otherwise they can simply read the Event bits and be informed about the performance
without implementing any algorithm.
The event signaling bits can be sent from the Server (that can do the performance
measurement calculation) to the Client, or vice versa.<a href="#section-4.1-5" class="pilcrow">¶</a></p>
<p id="section-4.1-6">If the CoAP PM Option is applied between client and server, a probe can measure
the total RTT by using the S bit, indeed it allows RTT measurement for all the intermediate points.
Additionally, with the Q bit and by applying <span>[<a href="#RFC9341" class="cite xref">RFC9341</a>]</span>, it is also possible to do
hop-by-hop measurements for loss and delay and segment where possible between the probes,
according to the methodologies described in <span>[<a href="#RFC9506" class="cite xref">RFC9506</a>]</span>.
Alternatively, it is possible to use the C bit to get the same information
for loss and delay as explained in <span>[<a href="#RFC9506" class="cite xref">RFC9506</a>]</span>.<a href="#section-4.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="cproxies">
<section id="section-4.2">
        <h3 id="name-collaborating-proxies">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-collaborating-proxies" class="section-name selfRef">Collaborating proxies</a>
        </h3>
<p id="section-4.2-1">The proxies can be "collaborating": this means that they understand and are
configured to handle the CoAP PM Option.
The CoAP PM Option can be handled on the client, on the server and on each
Proxies.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<span id="name-scenario-with-collaborating"></span><div id="Fig.2">
<figure id="figure-5">
          <div class="alignLeft art-text artwork" id="section-4.2-2.1">
<pre>
          client-proxy        proxy-proxy       proxy-server
           &lt;-------&gt;     &lt;-----------------&gt;     &lt;-------&gt;
  +--------+       +-----+                 +-----+       +--------+
  | Client |---+---|Proxy|--------+--------|Proxy|---+---| Server |
  +--------+   |   +-----+        |        +-----+   |   +--------+
               |                  |                  |
             probe              probe              probe
</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-scenario-with-collaborating" class="selfRef">Scenario with collaborating proxies</a>
          </figcaption></figure>
</div>
<p id="section-4.2-3">In case of collaborating proxies, the enabled measurements are different
depending on where the CoAP PM Option is applied.<a href="#section-4.2-3" class="pilcrow">¶</a></p>
<p id="section-4.2-4">It can be possible to apply the CoAP PM Option between Client and Proxy,
between the Proxies and between Proxy and Server.
The sessions are separated end-to-end between Client and Server and the enabled
measurements can be done on the separated sessions:<a href="#section-4.2-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2-5.1">
            <p id="section-4.2-5.1.1">loss and delay measurements between Client and Proxy, between Proxies and
between Proxy and Server,<a href="#section-4.2-5.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.2-5.2">
            <p id="section-4.2-5.2.1">on-path upstream and downstream loss and delay components (as explained in <span>[<a href="#RFC9506" class="cite xref">RFC9506</a>]</span>) on each Proxy,<a href="#section-4.2-5.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.2-5.3">
            <p id="section-4.2-5.3.1">on-path upstream and downstream loss and delay components (as explained in <span>[<a href="#RFC9506" class="cite xref">RFC9506</a>]</span>) on each Probe,<a href="#section-4.2-5.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.2-5.4">
            <p id="section-4.2-5.4.1">end-to-end loss and delay measurements as a result of the addition of the
loss and delay contributions of the separated sessions.<a href="#section-4.2-5.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.2-5.5">
            <p id="section-4.2-5.5.1">on-path intra-domain loss and delay portion as a result of the difference
between the computed upstream or downstream components
(as explained in <span>[<a href="#RFC9506" class="cite xref">RFC9506</a>]</span>).<a href="#section-4.2-5.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.2-6">So, if there are CoAP proxies, the measurement can be done between the Proxies
or between a Proxy and the Client or between a Proxy and the Server.
It can be done through Spin bit or by applying <span>[<a href="#RFC9341" class="cite xref">RFC9341</a>]</span> on the sQuare Bit signal.
Therefore, it is also possible to do hop-by-hop measurements for loss and delay and
segment where possible according to the methodologies described in <span>[<a href="#RFC9506" class="cite xref">RFC9506</a>]</span>.<a href="#section-4.2-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ncproxies">
<section id="section-4.3">
        <h3 id="name-non-collaborating-proxies">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-non-collaborating-proxies" class="section-name selfRef">Non-collaborating proxies</a>
        </h3>
<p id="section-4.3-1">The proxies can be non-collaborating and this means that they do not handle
the CoAP PM Option.
The CoAP PM Option can be applied end-to-end between client and server.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3-2">There are some issues that may occur in case of non-collaborating proxies.
In general, since CoAP proxies hide the identity of the client,
the data would appear mixed after the proxy in the presence of more than
one client doing the measurements.
Similarly, since CoAP proxies could also apply caching, it can happen to
receive mixed signals in the presence of cache entries.<a href="#section-4.3-2" class="pilcrow">¶</a></p>
<p id="section-4.3-3">In case of collaborating proxies, these issues are solved because the measurements
can be segmented and done between the Client and a Proxy
or between the Proxies or between a Proxy and the Server. In this case, it
could be possible for the proxy to still use the PM Option
for the bundle of clients for a specific server.<a href="#section-4.3-3" class="pilcrow">¶</a></p>
<p id="section-4.3-4">While, in case of non-collaborating proxies, it is <span class="bcp14">RECOMMENDED</span> to use the
Option only for a single client and a single server at once
in order to avoid that traffic from different clients would be mixed.
But, if the proxy has also cached data, the data can be reordered and mixed,
so that they cannot be used for measurement. For this reason, the PM Option
is defined as Proxy Unsafe: it is intended to be unsafe for forwarding
by a proxy that does not understand it. In conclusion, if there are non-collaborating
and caching proxies, the measurements would not be possible.<a href="#section-4.3-4" class="pilcrow">¶</a></p>
<div id="ncncproxies">
<section id="section-4.3.1">
          <h4 id="name-non-caching-proxies">
<a href="#section-4.3.1" class="section-number selfRef">4.3.1. </a><a href="#name-non-caching-proxies" class="section-name selfRef">Non-caching proxies</a>
          </h4>
<p id="section-4.3.1-1">An implementation <span class="bcp14">MAY</span> consider the PM Option as Safe-to-Forward if the proxies
are non-caching in general or in the only case the PM Option
is included in the message.<a href="#section-4.3.1-1" class="pilcrow">¶</a></p>
<span id="name-scenario-with-non-collabora"></span><div id="Fig.3">
<figure id="figure-6">
            <div class="alignLeft art-text artwork" id="section-4.3.1-2.1">
<pre>
                            client-server
           &lt;---------------------------------------------&gt;
  +--------+       +-----+                 +-----+       +--------+
  | Client |---+---|Proxy|--------+--------|Proxy|---+---| Server |
  +--------+   |   +-----+        |        +-----+   |   +--------+
               |                  |                  |
             probe              probe              probe
</pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-scenario-with-non-collabora" class="selfRef">Scenario with non-collaborating and non-caching proxies</a>
            </figcaption></figure>
</div>
<p id="section-4.3.1-3">In case of non-collaborating and non-caching proxies, proxies <span class="bcp14">MAY</span> be configured
to handle the PM Option as Safe-to-Forward, and
it means that not recognized option <span class="bcp14">MUST</span> be forwarded. Therefore, the enabled
measurements for a single client and a single server at once can be:<a href="#section-4.3.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.1-4.1">
              <p id="section-4.3.1-4.1.1">end-to-end loss and delay measurements between Client and Server,<a href="#section-4.3.1-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.3.1-4.2">
              <p id="section-4.3.1-4.2.1">on-path upstream and downstream loss and delay components (as explained in <span>[<a href="#RFC9506" class="cite xref">RFC9506</a>]</span>) on each Probe,<a href="#section-4.3.1-4.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.3.1-4.3">
              <p id="section-4.3.1-4.3.1">on-path intra-domain loss and delay portion as a result of the difference
between the computed upstream or downstream components
(as explained in <span>[<a href="#RFC9506" class="cite xref">RFC9506</a>]</span>).<a href="#section-4.3.1-4.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="dtls">
<section id="section-4.4">
        <h3 id="name-dtls">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-dtls" class="section-name selfRef">DTLS</a>
        </h3>
<p id="section-4.4-1">CoAP can be secured using Datagram TLS (DTLS) <span>[<a href="#RFC6347" class="cite xref">RFC6347</a>]</span> over UDP
and it can prevent on-path measures in case of non-proxying endpoints.
When a client uses a collaborating proxy the sessions client-proxy, proxy-proxy,
proxy-server are secured using DTLS, but the separated sessions can still be measured.
An on-path probe cannot perform the measurements in any case.<a href="#section-4.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="oscore">
<section id="section-4.5">
        <h3 id="name-oscore">
<a href="#section-4.5" class="section-number selfRef">4.5. </a><a href="#name-oscore" class="section-name selfRef">OSCORE</a>
        </h3>
<p id="section-4.5-1">The CoAP PM Option can be used with OSCORE <span>[<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>.
Since an OSCORE message may contain both an Inner and an Outer instance of
a certain CoAP message field,
the CoAP PM Option can be an Inner option or an Outer option based on the
specific applications and required security and privacy.
Then network administrators can put their measurement probes in one or more
places to break down the different RTT and loss contributions where it is relevant
(e.g. at the ingress/egress of their respective network segments).<a href="#section-4.5-1" class="pilcrow">¶</a></p>
<p id="section-4.5-2">Inner options (Class E) are used to communicate directly with the other endpoint
and are encrypted and integrity protected. If the CoAP PM Option is sent as Inner Option,
it only enables end-to-end measurements in all the cases.
In case of collaborating proxies the separated sessions client-proxy, proxy-proxy, proxy-server
cannot be measured.<a href="#section-4.5-2" class="pilcrow">¶</a></p>
<p id="section-4.5-3">Outer options (Class U or I) are intended to be used to support proxy operations
and are unprotected or integrity protected only.
If the CoAP PM Option is sent as Outer Option, it allows both end-to-end
and on-path measurements by enabling hop-by-hop and segmented loss and delay measurements on the proxies.<a href="#section-4.5-3" class="pilcrow">¶</a></p>
<p id="section-4.5-4">If an OSCORE endpoint sends both outer and inner option, the inner is for
measuring the connection to the end-to-end peer,
and the outer can be used for measuring the connection to next proxy.<a href="#section-4.5-4" class="pilcrow">¶</a></p>
<p id="section-4.5-5">If the PM option is used as an Outer Option, it may also be integrity-protected,
to be reliably processed and this would require using also DTLS or an OSCORE association with a proxy
<span>[<a href="#I-D.ietf-core-oscore-capable-proxies" class="cite xref">I-D.ietf-core-oscore-capable-proxies</a>]</span>.<a href="#section-4.5-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="MaO">
<section id="section-5">
      <h2 id="name-management-and-configuratio">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-management-and-configuratio" class="section-name selfRef">Management and Configuration</a>
      </h2>
<p id="section-5-1">The measurement points can perform RTT and packet loss calculation without
the need of any Network Management System (NMS) to collect information.
It may be possible that the measurement points inform the NMS if there are particular network conditions
(e.g. high packet loss or high RTT).
For some parameters (e.g. 64 packets sQuare Bit signal), it is assumed static
configuration on the client.
There are several alternatives for the implementation; this is out of
scope of this document.<a href="#section-5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="congestion-control">
<section id="section-6">
      <h2 id="name-congestion-control">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-congestion-control" class="section-name selfRef">Congestion Control</a>
      </h2>
<p id="section-6-1">As specified in Section 4.7 of <span>[<a href="#RFC7252" class="cite xref">RFC7252</a>]</span>, clients (including proxies)
have to strictly limit the number of simultaneous outstanding interactions
that they maintain to a given server (including proxies) to NSTART.
The default value of NSTART is 1 but a value for NSTART greater than one
is also possible.
The CoAP PM Option implementation must not affect CoAP congestion control
mechanisms.<a href="#section-6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-considerations">
<section id="section-7">
      <h2 id="name-security-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-7-1">Security considerations related to CoAP proxying are discussed in <span>[<a href="#RFC7252" class="cite xref">RFC7252</a>]</span>.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">A CoAP endpoint can use the CoAP PM Option to affect the measures of a network
into which it is making requests by maliciously specifying a wrong option value.
Also, the PM bits may reveal performance information outside the administrative
domain.
To prevent that, a CoAP proxy that is located at the boundary of an administrative
domain <span class="bcp14">MAY</span> be instructed to strip the payload or part of it before forwarding the
message.<a href="#section-7-2" class="pilcrow">¶</a></p>
<p id="section-7-3">It is worth highlighting what happens if devices, transport network and server
are operated by different administrative domains. Security concerns need to be
taken into account.<a href="#section-7-3" class="pilcrow">¶</a></p>
<p id="section-7-4">CoAP can be used with DTLS <span>[<a href="#RFC6347" class="cite xref">RFC6347</a>]</span> and it can prevent on-path measures
by on-path probes while it is still possible to do measurements on collaborating
proxies, as explained above.<a href="#section-7-4" class="pilcrow">¶</a></p>
<p id="section-7-5">CoAP can also be used with OSCORE <span>[<a href="#RFC8613" class="cite xref">RFC8613</a>]</span> and the CoAP PM options can be
integrity protected end-to-end by OSCORE.
In this case, as explained above and differently from DTLS, the CoAP PM can
easily work with OSCORE.
OSCORE ensures end-to-end integrity protection and would tell the endpoints
if someone tampered with the option value, but it doesn't mean that the endpoints
are not lying to the probe. However, it is possible to assume that for the typical
CoAP applications it is less likely that the endpoints are attackers while
it is more likely that an on-path probe is the attacker.<a href="#section-7-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="IANA">
<section id="section-8">
      <h2 id="name-iana-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-8-1">IANA is requested to add the following entry to the "CoAP Option
Numbers" sub-registry available at
https://www.iana.org/assignments/core-parameters/core-parameters.xhtml#option-numbers:<a href="#section-8-1" class="pilcrow">¶</a></p>
<span id="name-coap-pm-option-number"></span><div id="PMoptionNs">
<table class="center" id="table-2">
        <caption>
<a href="#table-2" class="selfRef">Table 2</a>:
<a href="#name-coap-pm-option-number" class="selfRef">CoAP PM Option Number</a>
        </caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">Number</th>
            <th class="text-left" rowspan="1" colspan="1">Name</th>
            <th class="text-left" rowspan="1" colspan="1">Reference</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">TBD</td>
            <td class="text-left" rowspan="1" colspan="1">PM</td>
            <td class="text-left" rowspan="1" colspan="1">[This document]</td>
          </tr>
        </tbody>
      </table>
</div>
</section>
</div>
<div id="sec-combined-references">
<section id="section-9">
      <h2 id="name-references">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-9.1">
        <h3 id="name-normative-references">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7252">[RFC7252]</dt>
        <dd>
<span class="refAuthor">Shelby, Z.</span>, <span class="refAuthor">Hartke, K.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"The Constrained Application Protocol (CoAP)"</span>, <span class="seriesInfo">RFC 7252</span>, <span class="seriesInfo">DOI 10.17487/RFC7252</span>, <time datetime="2014-06" class="refDate">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7252">https://www.rfc-editor.org/rfc/rfc7252</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8613">[RFC8613]</dt>
        <dd>
<span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Mattsson, J.</span>, <span class="refAuthor">Palombini, F.</span>, and <span class="refAuthor">L. Seitz</span>, <span class="refTitle">"Object Security for Constrained RESTful Environments (OSCORE)"</span>, <span class="seriesInfo">RFC 8613</span>, <span class="seriesInfo">DOI 10.17487/RFC8613</span>, <time datetime="2019-07" class="refDate">July 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8613">https://www.rfc-editor.org/rfc/rfc8613</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9341">[RFC9341]</dt>
      <dd>
<span class="refAuthor">Fioccola, G., Ed.</span>, <span class="refAuthor">Cociglio, M.</span>, <span class="refAuthor">Mirsky, G.</span>, <span class="refAuthor">Mizrahi, T.</span>, and <span class="refAuthor">T. Zhou</span>, <span class="refTitle">"Alternate-Marking Method"</span>, <span class="seriesInfo">RFC 9341</span>, <span class="seriesInfo">DOI 10.17487/RFC9341</span>, <time datetime="2022-12" class="refDate">December 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9341">https://www.rfc-editor.org/rfc/rfc9341</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-9.2">
        <h3 id="name-informative-references">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-core-oscore-capable-proxies">[I-D.ietf-core-oscore-capable-proxies]</dt>
        <dd>
<span class="refAuthor">Tiloca, M.</span> and <span class="refAuthor">R. Höglund</span>, <span class="refTitle">"OSCORE-capable Proxies"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-core-oscore-capable-proxies-03</span>, <time datetime="2024-10-21" class="refDate">21 October 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-capable-proxies-03">https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-capable-proxies-03</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6347">[RFC6347]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span> and <span class="refAuthor">N. Modadugu</span>, <span class="refTitle">"Datagram Transport Layer Security Version 1.2"</span>, <span class="seriesInfo">RFC 6347</span>, <span class="seriesInfo">DOI 10.17487/RFC6347</span>, <time datetime="2012-01" class="refDate">January 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6347">https://www.rfc-editor.org/rfc/rfc6347</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7641">[RFC7641]</dt>
        <dd>
<span class="refAuthor">Hartke, K.</span>, <span class="refTitle">"Observing Resources in the Constrained Application Protocol (CoAP)"</span>, <span class="seriesInfo">RFC 7641</span>, <span class="seriesInfo">DOI 10.17487/RFC7641</span>, <time datetime="2015-09" class="refDate">September 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7641">https://www.rfc-editor.org/rfc/rfc7641</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9000">[RFC9000]</dt>
        <dd>
<span class="refAuthor">Iyengar, J., Ed.</span> and <span class="refAuthor">M. Thomson, Ed.</span>, <span class="refTitle">"QUIC: A UDP-Based Multiplexed and Secure Transport"</span>, <span class="seriesInfo">RFC 9000</span>, <span class="seriesInfo">DOI 10.17487/RFC9000</span>, <time datetime="2021-05" class="refDate">May 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9000">https://www.rfc-editor.org/rfc/rfc9000</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9312">[RFC9312]</dt>
        <dd>
<span class="refAuthor">Kühlewind, M.</span> and <span class="refAuthor">B. Trammell</span>, <span class="refTitle">"Manageability of the QUIC Transport Protocol"</span>, <span class="seriesInfo">RFC 9312</span>, <span class="seriesInfo">DOI 10.17487/RFC9312</span>, <time datetime="2022-09" class="refDate">September 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9312">https://www.rfc-editor.org/rfc/rfc9312</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9506">[RFC9506]</dt>
      <dd>
<span class="refAuthor">Cociglio, M.</span>, <span class="refAuthor">Ferrieux, A.</span>, <span class="refAuthor">Fioccola, G.</span>, <span class="refAuthor">Lubashev, I.</span>, <span class="refAuthor">Bulgarella, F.</span>, <span class="refAuthor">Nilo, M.</span>, <span class="refAuthor">Hamchaoui, I.</span>, and <span class="refAuthor">R. Sisto</span>, <span class="refTitle">"Explicit Host-to-Network Flow Measurements Techniques"</span>, <span class="seriesInfo">RFC 9506</span>, <span class="seriesInfo">DOI 10.17487/RFC9506</span>, <time datetime="2023-10" class="refDate">October 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9506">https://www.rfc-editor.org/rfc/rfc9506</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="Acknowledgements">
<section id="appendix-A">
      <h2 id="name-acknowledgements">
<a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="appendix-A-1">The authors would like to thank
<span class="contact-name">Christian Amsüss</span>,
<span class="contact-name">Carsten Bormann</span>,
<span class="contact-name">Marco Tiloca</span>,
<span class="contact-name">Thomas Fossati</span>
for the precious comments and suggestions.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="contributors">
<section id="appendix-B">
      <h2 id="name-contributors">
<a href="#name-contributors" class="section-name selfRef">Contributors</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Mauro Cociglio</span></div>
<div dir="auto" class="left"><span class="org">Telecom Italia</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:mauro.cociglio@outlook.com" class="email">mauro.cociglio@outlook.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Fabrizio Milan</span></div>
<div dir="auto" class="left"><span class="org">Telecom Italia</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:fabrizio.milan@telecomitalia.it" class="email">fabrizio.milan@telecomitalia.it</a>
</div>
</address>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-C">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Giuseppe Fioccola</span></div>
<div dir="auto" class="left"><span class="org">Huawei</span></div>
<div dir="auto" class="left"><span class="street-address">Palazzo Verrocchio, Centro Direzionale Milano 2</span></div>
<div dir="auto" class="left">
<span class="postal-code">20054</span> <span class="locality">Segrate (Milan)</span> </div>
<div dir="auto" class="left"><span class="country-name">Italy</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:giuseppe.fioccola@huawei.com" class="email">giuseppe.fioccola@huawei.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Tianran Zhou</span></div>
<div dir="auto" class="left"><span class="org">Huawei</span></div>
<div dir="auto" class="left"><span class="street-address">156 Beiqing Rd.</span></div>
<div dir="auto" class="left"><span class="locality">Beijing</span></div>
<div dir="auto" class="left"><span class="postal-code">100095</span></div>
<div dir="auto" class="left"><span class="country-name">China</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:zhoutianran@huawei.com" class="email">zhoutianran@huawei.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Massimo Nilo</span></div>
<div dir="auto" class="left"><span class="org">Telecom Italia</span></div>
<div dir="auto" class="left"><span class="street-address">Via Reiss Romoli, 274</span></div>
<div dir="auto" class="left">
<span class="postal-code">10148</span> <span class="locality">Torino</span> </div>
<div dir="auto" class="left"><span class="country-name">Italy</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:massimo.nilo@telecomitalia.it" class="email">massimo.nilo@telecomitalia.it</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Fabio Bulgarella</span></div>
<div dir="auto" class="left"><span class="org">Telecom Italia</span></div>
<div dir="auto" class="left"><span class="street-address">Via Reiss Romoli, 274</span></div>
<div dir="auto" class="left">
<span class="postal-code">10148</span> <span class="locality">Torino</span> </div>
<div dir="auto" class="left"><span class="country-name">Italy</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:fabio.bulgarella@guest.telecomitalia.it" class="email">fabio.bulgarella@guest.telecomitalia.it</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
